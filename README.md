# AI Sales Agent

Чат-бот для продажи автозапчастей для немецких автомобилей с использованием RAG (Retrieval-Augmented Generation) и Sentence Transformers. ИИ помогает клиентам выбрать запчасти, обрабатывает возражения и доводит до покупки, вызывая функции для отправки счетов или передачи запросов менеджеру.

## Описание

Проект реализует ИИ-продавца, который:
- Приветствует клиентов и выясняет их потребности (модель, год выпуска, запчасть).
- Ищет подходящие запчасти в каталоге, используя семантический поиск (FAISS + Sentence Transformers).
- Предлагает оригинальные и аналоговые запчасти с указанием артикула и цены.
- Обрабатывает возражения (например, о цене или качестве аналога).
- Запрашивает контактные данные для оформления заказа.
- Вызывает функции `send_invoice` для отправки счета или `handover_to_manager` для передачи сложных запросов менеджеру.

## Установка

1. Создайте виртуальное окружение с Python 3.10:
   ```bash
   conda create -n ai_sales_env python=3.10
   conda activate ai_sales_env
   ```

2. Установите зависимости:
   ```bash
   conda install -c conda-forge faiss-cpu=1.7.4 sentencepiece=0.1.99 numpy=1.26.4 tqdm
   pip install sentence-transformers==2.2.2 huggingface_hub==0.16.4 tokenizers==0.13.3 transformers==4.30.2
   ```

## Запуск

1. Убедитесь, что вы находитесь в корневой директории проекта.
2. Запустите основной скрипт:
   ```bash
   python3 src/main.py
   ```

Скрипт выполнит три демонстрационных диалога, показывающих работу чат-бота.

## Структура проекта

- **`data/`**:
  - `catalog_chunks.json`: Каталог запчастей с текстом и метаданными (ID, название, совместимость, цена, артикул).
  - `sales_templates.json`: Шаблоны ответов для диалогов (приветствие, предложение, обработка возражений).
- **`src/`**:
  - `main.py`: Основной скрипт с логикой диалогов и интеграцией RAG.
  - `retriever.py`: Модуль для семантического поиска с использованием FAISS и Sentence Transformers.
  - `function_calling_logic.py`: Функции для отправки счетов и передачи запросов менеджеру.
- **`requirements.txt`**: Список зависимостей Python.
- **`LICENSE`**: Лицензия MIT.
- **`system_prompt.txt`**: Системный промпт, задающий поведение ИИ.

## Возможности диалогов

Чат-бот поддерживает следующие сценарии:
- Приветствует клиента при сообщениях вроде "Здравствуйте" или "Привет".
- Выясняет модель, год выпуска и нужную запчасть (например, "XDrive 2009, моторчик омывателя").
- Предлагает оригинал и аналог, если они есть в каталоге, с указанием названия, артикула и цены.
- Обрабатывает возражения:
  - На высокую цену: подчеркивает качество оригинала и предлагает аналог.
  - На качество аналога: уверяет в надежности.
- Если запчасть не найдена, передает запрос менеджеру через `handover_to_manager`.
- После выбора запчасти запрашивает имя и телефон клиента.
- Отправляет счет через `send_invoice` после получения контактов.

## Примеры использования

Запустите `main.py` для просмотра трех демонстрационных диалогов:
1. Клиент запрашивает моторчик омывателя для XDrive 2009, выбирает оригинал и оформляет заказ.
2. Клиент интересуется задним фонарем для Cruiser 2012, уточняет качество аналога и заказывает его.
3. Клиент ищет лямбда-зонд для Vento 2010, возражает по цене, выбирает аналог и оформляет заказ.

## Лицензия

Проект распространяется под лицензией MIT. См. файл `LICENSE` для подробностей.

## Возможные улучшения

- Поддержка частичных совпадений моделей (например, "Golf" вместо "XDrive G6").
- Улучшение парсинга контактных данных для разных форматов.
- Обработка неоднозначных запросов (например, "фильтр" без уточнения типа).
- Интеграция с реальной базой данных или API для динамического обновления каталога.
